<script>
  window.onload = function () {
    const savedAnswers = JSON.parse(localStorage.getItem("quizAnswers")) || {};
    for (let q in savedAnswers) {
      const selector = `input[name="${q}"][value="${savedAnswers[q]}"]`;
      const input = document.querySelector(selector);
      if (input) input.checked = true;
    }
  };

  document.addEventListener("change", function (e) {
    if (e.target && e.target.name.startsWith("q")) {
      const currentAnswers = JSON.parse(localStorage.getItem("quizAnswers")) || {};
      currentAnswers[e.target.name] = e.target.value;
      localStorage.setItem("quizAnswers", JSON.stringify(currentAnswers));
    }
  });

  function checkAnswers() {
    const q1 = document.querySelector('input[name="q1"]:checked');
    const q2 = document.querySelector('input[name="q2"]:checked');
    const q3 = document.querySelector('input[name="q3"]:checked');

    let correct = 0;
    if (q1 && q1.value === 'a') correct++;
    if (q2 && q2.value === 'a') correct++;

    const modal = document.getElementById("resultModal");
    const title = document.getElementById("resultTitle");
    const message = document.getElementById("resultMessage");

    if (!q1 || !q2 || !q3) {
      title.textContent = "Oops!";
      message.textContent = "Please answer all questions before submitting.";
    } else if (correct === 2) {
      title.textContent = "🎉 You're a Medieval Feast Master!";
      message.textContent = "Congratulations! You’re now a medieval expert!";
    } else {
      title.textContent = "🧐 Almost there...";
      message.textContent = `You got ${2 - correct} question${(2 - correct) > 1 ? 's' : ''} wrong. Think again!`;
    }

    modal.style.display = "flex";
  }

  function clearAnswersAndRetry() {
    localStorage.removeItem("quizAnswers");
    location.reload();
  }
</script>
